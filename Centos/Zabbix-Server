1 # Install neue Version MariaDB-Server.
2 # Install neue Zabbix 5.2 Server

### 1 ### Install neue Version MariaDB-Server.
# vim /etc/yum.repos.d/mariadb.repo

    # MariaDB 10.5 CentOS repository list - created 2020-12-27 16:35 UTC
    # http://downloads.mariadb.org/mariadb/repositories/
    [mariadb]
    name = MariaDB
    baseurl = http://yum.mariadb.org/10.5/centos8-amd64
    module_hotfixes=1
    gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
    gpgcheck=1
    
# dnf install -y MariaDB-server MariaDB-client

# systemctl start mariadb
# systemctl enable mariadb

# mysql_secure_installation

# vim /etc/my.cnf.d/server.cnf
[client]
port		= 3306
socket		= /var/lib/mysql/mysql.sock
default-character-set=utf8

[mysqld]
character_set_server=utf8
collation-server=utf8_bin
init_connect="SET NAMES utf8 collate utf8_bin"
port		= 3306
socket		= /var/lib/mysql/mysql.sock

innodb_file_per_table=1
innodb_buffer_pool_size = 768M # внимание на параметр! установить примерно в 2 раза меньше объема оперативной пам¤ти сервера
innodb_buffer_pool_instances=1 # увеличивать на 1 каждый GB innodb_buffer_pool_size
innodb_flush_log_at_trx_commit = 0
innodb_log_file_size = 512M
innodb_log_files_in_group = 3

# systemctl restart mariadb
# systemctl status mariadb


### 2 ### Install neue Zabbix 5.2 Server
## https://www.zabbix.com/download?zabbix=5.2&os_distribution=centos&os_version=8&db=mysql&ws=nginx

a. Install Zabbix repository
# rpm -Uvh https://repo.zabbix.com/zabbix/5.2/rhel/8/x86_64/zabbix-release-5.2-1.el8.noarch.rpm
# dnf clean all

b. Install Zabbix server, frontend, agent
# dnf install -y zabbix-server-mysql zabbix-web-mysql zabbix-nginx-conf zabbix-agent

c. Create initial database
# mysql -uroot -p
<password> - von root DB
    mysql> create database zabbix character set utf8 collate utf8_bin;
    mysql> create user zabbix@localhost identified by 'zbxhilton!';
    mysql> grant all privileges on zabbix.* to zabbix@localhost;
    mysql> quit;

# zcat /usr/share/doc/zabbix-server-mysql*/create.sql.gz | mysql -uzabbix -p zabbix
<password> - von zabbix@localhost

d. Configure the database for Zabbix server
# vim /etc/zabbix/zabbix_server.conf
    DBHost=localhost
    DBName=zabbix
    DBUser=zabbix
    DBPassword=zbxhilton!
    ListenIP=0.0.0.0
    Timeout=30
    
e. Configure PHP for Zabbix frontend
# vim /etc/nginx/conf.d/zabbix.conf
    listen 80 default_server;   # sollte sein
    server_name zabbix5;
    
# vim /etc/nginx/nginx.conf
    listen 80;      #sollte sein
    listen [::]:80;

# vim /etc/php-fpm.d/zabbix.conf
    php_value[date.timezone] = Europe/Berlin
    
f. Start Zabbix server and agent processes
# systemctl restart zabbix-server zabbix-agent nginx php-fpm
# systemctl enable zabbix-server zabbix-agent nginx php-fpm

g. Configure Zabbix frontend
http://server_ip_or_name
